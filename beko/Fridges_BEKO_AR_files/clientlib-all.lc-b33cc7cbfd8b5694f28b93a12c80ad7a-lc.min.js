/** a JS file that shall be included */
(function () {
  "use strict";
  $(document).ready(function () {
    let player;

    window.onYouTubePlayerAPIReady = function() {
      const element = $('#productVideo');
      const width = element.width();
      const height = element.height();
      const data = element.data();
      if (!data) {
        return;
      }
      player = new YT.Player('productVideo', {
        width: width,
        height: height,
        videoId: data.videoId,
        origin: window.location.origin
      });
    };

    $('.JS-modal-open[data-modal-id=product_video_modal]').click(function () {
      if (player) {
        return;
      }
      let tag = document.createElement('script');
      tag.src = "https://www.youtube.com/player_api";
      let firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    });

    $('.JS-modal-close[data-modal-id=product_video_modal]').click(function () {
      if (!player) {
        return;
      }
      player.stopVideo();
    });
  });
})();
