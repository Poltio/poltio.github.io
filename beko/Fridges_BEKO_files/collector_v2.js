var EnhCollector=class e{constructor(e,t){this.uid=e,t&&(this.cid=t),this.visitorID="",this.enh_last_access="",this.isTimeValid=!0,this.type="ecommerce",this.org="https://collect.enhencer.com/api",this.fbExtID="",this.epid="795653402096404",this.lsr,this.anle,this.nanle}init(){document.cookie&&(null!==this.getCookie("enh_visitor_session")?this.visitorID=this.getCookie("enh_visitor_session"):(this.visitorID=this.generateVisitorID(),this.setCookie("enh_visitor_session",this.visitorID,120),this.setCookie("enh_source",document.referrer,120)),null!==this.getCookie("enh_token")&&void 0===this.uid?this.uid=this.getCookie("enh_token"):null===this.getCookie("enh_token")&&void 0!==this.uid&&this.setCookie("enh_token",this.uid,120),null!==this.getCookie("g_conv_id")&&void 0===this.cid?this.cid=this.getCookie("g_conv_id"):null===this.getCookie("g_conv_id")&&void 0!==this.uid&&this.setCookie("g_conv_id",this.cid,120),null!==this.getCookie("enh_last_access")&&(this.enh_last_access=parseInt(this.getCookie("enh_last_access"))),this.setCookie("enh_last_access",new Date().getTime(),120),this.lsr=this.getCookie("enh_lsr_a"),this.anle=this.getCookie("enh_anle"),this.nanle=this.getCookie("enh_nanle"),new Date().getTime()-this.enh_last_access<3500&&(this.isTimeValid=!1))}productPage(e){if(!this.uid||!this.isTimeValid)return console.log("No token. Contact Enhencer Integration Team at hello@enhencer.com"),"No token. Contact Enhencer Integration Team at hello@enhencer.com";{let t=this.getDeviceType(),i="";e&&(i=null!==e.productCategory&&void 0!==e.productCategory?e.productCategory:e.productCategory2);let o=JSON.stringify({visitorID:this.visitorID,type:this.type,productID:e&&e.productID?e.productID:"no-id",productCategory2:i?i.trim():"",price:e&&e.price?parseInt(e.price):1,deviceType:t,product_viewer:1,source:null===this.getCookie("enh_source")?"":this.getCookie("enh_source"),actionType:"product",userID:this.uid,id:this.visitorID}),n=new XMLHttpRequest;n.open("Post",`${this.org}/products/`,!0),n.send(o),this.#a()}}listingPage(e){if(!this.uid||!this.isTimeValid)return console.log("No token. Contact Enhencer Integration Team at hello@enhencer.com"),"No token. Contact Enhencer Integration Team at hello@enhencer.com";{let t=this.getDeviceType(),i="",o="";e&&(void 0!==e.listingCategory1&&null!==e.listingCategory1?(i=e.listingCategory1,o=e.listingCategory2):void 0!==e.listingCategory&&null!==e.listingCategory?(i=e.listingCategory,o=""):(i=e.productCategory1,o=e.productCategory2));let n=JSON.stringify({type:this.type,visitorID:this.visitorID,productCategory1:i?i.trim():"",productCategory2:o?o.trim():"",deviceType:t,source:null===this.getCookie("enh_source")?"":this.getCookie("enh_source"),userID:this.uid,id:this.visitorID}),s=new XMLHttpRequest;s.open("Post",`${this.org}/listings/`,!0),s.send(n),this.#a()}}addedToBasket(e){if(!this.uid)return console.log("No token. Contact Enhencer Integration Team at hello@enhencer.com"),"No token. Contact Enhencer Integration Team at hello@enhencer.com";{let t=JSON.stringify({type:this.type,visitorID:this.visitorID,productID:e&&e.productID?e.productID:"no-id",actionType:"basket",userID:this.uid,id:this.visitorID}),i=new XMLHttpRequest;i.open("Post",`${this.org}/purchases/`,!0),i.send(t),this.#a()}}conversion(){this.purchased({products:[{id:"conversion",quantity:1,price:1}]})}purchased(e){if(!this.uid)return console.log("No token. Contact Enhencer Integration Team at hello@enhencer.com"),"No token. Contact Enhencer Integration Team at hello@enhencer.com";{let t=[];e&&e.products&&e.products.length>0?e.products.forEach(e=>{let i={};e.item_id?i.id=e.item_id:e.id?i.id=e.id:i.id="no-id",e.item_quantity?i.quantity=e.item_quantity:e.quantity?i.quantity=e.quantity:i.quantity=1,e.item_price?i.price=parseInt(e.item_price):e.price?i.price=parseInt(e.price):i.price=1,t.push(i)}):t=[{id:"no-id",quantity:1,price:1}];let i=Date.now().toString(),o=JSON.stringify({visitorID:this.visitorID,type:this.type,basketID:i,products:t,actionType:"purchase",userID:this.uid,id:this.visitorID}),n=new XMLHttpRequest;n.open("Post",`${this.org}/purchases/`,!0),n.send(o),this.#a()}}#a(){let t=this;if(this.lsr){let i=t.refreshEventIdsOfCachedResult(t.lsr);t.#b(i,!1),t.#c(i)}else{let o=JSON.stringify({type:t.type,visitorID:t.visitorID,deviceType:t.getDeviceType(),source:t.getCookie("enh_source")||"",userID:t.uid,id:t.visitorID,eventSourceUrl:window.location.href,fbp:t.getCookie("_fbp"),userAgent:navigator.userAgent}),n=new XMLHttpRequest;n.open("Put",`${this.org}/customers/${t.visitorID}`,!0),n.setRequestHeader("Content-Type","text/plain"),n.send(o),n.onreadystatechange=function(){if(4!=this.readyState||202!=this.status)return"Error: No segment info for this user.";t.#b(n.responseText,!0)}}}#b(s,r){let a="object"!=typeof s?JSON.parse(s):s;a.campaigns?.length&&r&&(this.setCookie("enh_lsr_a",s,3),this.lsr=s);let c=this;a.conversionId&&(this.cid=a.conversionId),c.#d(a),c.#e(a),c.#f(a);let h=Date.now(),l=setInterval(function(){let e=Date.now();"undefined"!=typeof fbq&&((a.isAnEnabled||a.anEnabled)&&c.#g(a),c.#h(a),clearInterval(l)),e-h>5e3&&clearInterval(l)},500)}#c(d){let g=JSON.stringify({userId:this.uid,eventSourceUrl:window.location.href,fbp:this.getCookie("_fbp"),userAgent:navigator.userAgent,savedScoreApiResponse:d}),u=new XMLHttpRequest;u.open("Post",`${this.org}/customers/fbcapi/`,!0),u.send(g)}#f(p){let m={event:"enhencer.ready",enhencer:{}};p.audiences&&p.audiences.forEach(e=>{m[e.name.replaceAll(" ","_").toLowerCase()]=1}),p.campaigns&&p.campaigns.forEach(e=>{m.enhencer[e.name]=1}),"undefined"!=typeof dataLayer&&dataLayer.push(m)}#g(f){if(!this.anle||!this.nanle){fbq("init",this.epid),fbq("trackCustom","enh_an",{score:parseFloat(f["Likely to buy"]),uplift:parseFloat(f.Uplift),enhencerCategories:f.enhencerCategories,country:f.country});let v=Date.now();this.anle=v,this.nanle=v,this.setCookie("enh_anle",v,30),this.setCookie("enh_nanle",v,30)}}#h(C){C.audiences&&C.audiences.forEach(e=>{if("Facebook"===e.adPlatform){let t={};e.eventId&&(t.eventID=e.eventId),fbq("trackCustom",e.name,{},t)}}),C.campaigns&&C.campaigns.forEach(e=>{if("Facebook"===e.adPlatform){let t={},i={};e.eventId&&(i.eventID=e.eventId),e.bundles&&e.bundles.length>0&&e.bundles.forEach(e=>{t[e.name]=e.value}),fbq("trackCustom",e.name,t,i)}})}#d(k){let y={};k.audiences&&k.audiences.forEach(e=>{"Google"===e.adPlatform&&(y[e.name.replaceAll(" ","_").toLowerCase()]=1)}),this.cid&&(y.send_to="AW-"+this.cid,this.#i("page_view",y)),this.cid&&k.campaigns&&k.campaigns.forEach(e=>{if("Google"===e.adPlatform){let t={};e.bundles&&e.bundles.length>0&&e.bundles.forEach(e=>{t[e.name]=e.value}),t.send_to="AW-"+this.cid,this.#i(e.name,t)}})}#i($,I){this.#j()?("undefined"==typeof gtag&&this.#k(),gtag("event",$,I)):(this.#l(),this.#k(),gtag("event",$,I))}#j(){let D=document.getElementsByTagName("script");for(var b=0;b<D.length;b++)if(D[b].src&&D[b].src.includes("www.googletagmanager.com/gtag/js"))return!0;return!1}#l(){let T=document.createElement("script");T.src="https://www.googletagmanager.com/gtag/js?id=AW-"+this.cid,document.getElementsByTagName("head")[0].appendChild(T),window.dataLayer=window.dataLayer||[]}#k(){function gtag(){dataLayer.push(arguments)}window.gtag=gtag,gtag("js",new Date),gtag("config","AW-"+this.cid,{send_page_view:!1})}#e(w){if(w.tiktok&&"undefined"!=typeof ttq){for(var _=0;_<w.campaigns.length;_++)if("enh_conv_rem"===w.campaigns[_].name){ttq.track(w.campaigns[_].name);break}}}refreshEventIdsOfCachedResult(e){let t=this,i={...JSON.parse(e)};return i.campaigns.forEach(e=>{if("Facebook"===e.adPlatform){let i=Date.now().toString()+Math.floor(1e4*Math.random()).toString(),o="eid."+i.substring(5)+"."+t.vid;e={...e,eventId:o}}}),i.audiences.map(e=>{if("Facebook"===e.adPlatform){let i=Date.now().toString()+Math.floor(1e4*Math.random()).toString(),o="eid."+i.substring(5)+"."+t.vid;e={...e,eventId:o}}}),i}getCookie(e){for(var t=e+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){for(var n=i[o];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null}setCookie(e,t,i,o){var n="";if(i){var s=new Date;s.setTime(s.getTime()+864e5*i),n="; expires="+s.toUTCString()}document.cookie=`${e}=${t||""}${n};path=/;${o?"domain=ngrok-free.app;":""}`}generateVisitorID(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=t.length,o=0;o<10;o++)e+=t.charAt(Math.floor(Math.random()*i));return e}eraseCookie(e){document.cookie=e+"=; Max-Age=-99999999;"}getDeviceType(){let e=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(e)?"tablet":/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(e)?"mobile":"desktop"}};if(void 0===window.enhencerCollector||void 0===window.enhencerCollector.uid){let e=document.currentScript.getAttribute("src"),t,i;(e=e.replace(/\r?\n|\r/,"").trim()).split("?")[1].split("&").forEach(e=>{e.includes("token")&&(t=e.substring(e.indexOf("token=")+6))}),window.enhencerCollector=new EnhCollector(t,i),window.enhencerCollector.init()}