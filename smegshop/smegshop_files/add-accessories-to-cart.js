(()=>{/*!************************************************!*\
  !*** ./src/scripts/add-accessories-to-cart.js ***!
  \************************************************/document.addEventListener("DOMContentLoaded",()=>{initAccessoryButtonHandler(),closeDrawerOnOverlayClick()}),["drawer:updated","cart:updated","cart:refresh","main-cart:updated"].forEach(event=>{document.addEventListener(event,()=>{initAccessoryButtonHandler()})});const initAccessoryButtonHandler=()=>{const container=document.querySelector("main, .cart__items, .accessories-list");!container||container.dataset.accessoryBound==="true"||(container.dataset.accessoryBound="true",container.addEventListener("click",async function(e){const button=e.target.closest(".add-accessory-btn");if(!button||(e.preventDefault(),button.classList.contains("is--loading")))return;button.classList.add("is--loading");const variantId=button.dataset.variantId,accessoryElement=button.closest(".horizontal-product");try{if(!(await fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:variantId,quantity:1})})).ok)throw new Error("Failed to add accessory");const cart=await fetch("/cart.js").then(res=>res.json()),sectionId=document.querySelector("cart-items, main-cart")?.getAttribute("data-section-id");if(!sectionId)throw new Error("Section ID not found");const sectionHtml=await fetch(`?section_id=${sectionId}`).then(res=>res.text());cart.sections={[sectionId]:sectionHtml};const newSection=new DOMParser().parseFromString(sectionHtml,"text/html").querySelector(`[data-section-id="${sectionId}"]`),currentSection=document.querySelector(`[data-section-id="${sectionId}"]`);newSection&&currentSection&&(currentSection.innerHTML=newSection.innerHTML,document.dispatchEvent(new CustomEvent("main-cart:updated"))),theme.pubsub.publish(theme.pubsub.PUB_SUB_EVENTS.cartUpdate,{source:"accessory-add",cart}),accessoryElement?.remove()}catch(err){console.error("Error adding accessory:",err)}finally{button.classList.remove("is--loading")}}))},closeDrawerOnOverlayClick=()=>{const drawerContainer=document.querySelector('[id$="__cart-drawer"].shopify-section-group-overlay-group'),drawer=drawerContainer?.querySelector("#CartDrawer");drawerContainer&&(drawerContainer.addEventListener("click",event=>{const overlay=event.target.closest(".overlay"),closeButton=event.target.closest(".cart-drawer__close");(overlay||closeButton)&&(drawer.removeAttribute("open"),document.body.classList.remove("has-modal-open"))}),document.addEventListener("keydown",e=>{e.key==="Escape"&&drawer&&drawer.hasAttribute("open")&&(drawer.removeAttribute("open"),document.body.classList.remove("has-modal-open"))}))}})();
//# sourceMappingURL=/cdn/shop/t/5/assets/add-accessories-to-cart.js.map?v=131925655219360822331747726821
