var allIds=[];function getAllIds(){return allIds&&0<allIds.length||$(".listItem").each(function(){var t=$(this).attr("id");allIds.push(t)}),allIds}function getIdsByFilterValue(t){var e=[];return $(".listItem."+t).each(function(){var t=$(this).attr("id");e.push(t)}),e}function getIdsByGroup(t){var e=[],i=t+" input:checked";return 0===$(t+" input:checked").length?e=getAllIds():$(i).each(function(){var t=getIdsByFilterValue($(this).val());$.merge(e,t)}),$.uniqueArray(e)}function getIdsByOthersGroups(t){var e=getAllIds();return $(".filters__item__content[data-attr!="+t+"]").each(function(){var t=getIdsByGroup(".filters__item__content[data-attr="+$(this).attr("data-attr")+"]");e=$.arrayIntersect(e,t)}),$.uniqueArray(e)}function showItems(){var e=getAllIds();$(".filters__item__content").each(function(){var t=getIdsByGroup(".filters__item__content[data-attr="+$(this).attr("data-attr")+"]"),t=$.arrayIntersect(t,e);0!==t.length&&(e=t)}),$(".listItem").hide();for(var t=0;t<e.length;t++)$(".listItem#"+e[t]).show();return e}function updateCheckbox(){$(".filters__item__content").each(function(){var e=getIdsByOthersGroups($(this).attr("data-attr"));$(this).find("input").each(function(){var t=getIdsByFilterValue($(this).val());0===$.arrayIntersect(t,e).length?($(this).prop("disabled",!0),$(this).prop("checked",!1)):$(this).prop("disabled",!1)})})}function generateFiltersQueryParameter(){var e,t=[];$(".filter-checkbox:checkbox:checked").each(function(){$(this)&&!$(this).prop("disabled")&&t.push($(this).val())}),t&&0<t.length?(e="",t.forEach(function(t){e+=t+","}),e="?filters="+e.slice(0,-1),$("#filters_reset_link").css("display","block")):$("#filters_reset_link").css("display","none"),window.history.replaceState(null,null,e||"?")}function hideFilterContainerIfEmpty(){0===$(".filters__item").filter(function(t,e){return"none"!==$(e).css("display")}).length&&$("#product_filters_container").css("display","none")}function getQueryParameterByName(t,e){t=t.replace(/[\[\]]/g,"\\$&");t=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}function applyFiltersFromQueryParameter(){var e=!1,t=getQueryParameterByName("filters",window.location.href);t&&((t=t.split(","))&&0<t.length&&t.forEach(function(t){t=$(".filters input."+t);t&&!t.prop("disabled")&&(t.prop("checked",!0),t.closest(".filters__item").find(".filters__item__header").removeClass("collapsed").addClass("show"),t.closest(".filters__item__content").removeClass("collapse").addClass("show")),showItems(),updateCheckbox(),e=!0}),$("#filters_reset_link").css("display","block")),e||(showItems(),updateCheckbox())}function showUniqueFilters(t){0<$(".listItem."+t+"_1").length&&$(".filter-checkbox."+t+"_1").closest(".filters__item--unique").show()}function initSortingButtons(){function e(i){l(function(t,e){t=(t=$(t).data("price"))&&parseFloat(t),e=$(e).data("price");return t<(e=e&&parseFloat(e))?i?-1:1:e<t?i?1:-1:0}),r.append(s)}var r=$(".products-list"),s=r.children("div"),t=$("#price_order"),l=Array.prototype.sort.bind(s);t.on("select2:select",function(t){t=t.params.data;"price_asc_button"===t.id?e(!0):"price_desc_button"===t.id?e(!1):"relevance_button"===t.id&&(l(function(t,e){t=(t=$(t).data("presentation-order"))&&parseInt(t),e=$(e).data("presentation-order");return t<(e=e&&parseInt(e))?-1:1}),r.append(s))})}var filters={setup:function(){this._productFiltersSelector="product_filters",this.$productFilters=$("#"+this._productFiltersSelector),this.$productList=$("#product-list-container"),this._headerHeight=$(".mobile-menu").outerHeight(),this._filtersScrollTop=$(".filters_title ").offset().top-this._headerHeight-10,this.$filtersBtnReset=$(".filters_buttons .resetFilters"),this.$filtersActiveBox=$("#mobile_filters_active_box"),this.$filtersTotalResult=$(".filters_total_results"),this.$body=$("body")},scrollTop:function(){$("html, body").scrollTop(this._filtersScrollTop)},resetFilters:function(t){$(".filters input").each(function(){$(this).prop("checked",!1)}),showItems(),updateCheckbox(),generateFiltersQueryParameter(),t?($(".filters__item__content").collapse("hide"),this.$filtersActiveBox.hide()):this.updateMobileFiltersTotal()},resetSingleFilterGroup:function(t){$(".filters input[data-filter="+t+"]").prop("checked",!1),$("li.filter_item[data-attr="+t+"]").remove(),$(".filters__item__content[data-attr="+t+"]").collapse("hide"),$("li.filter_item").length||this.$filtersActiveBox.hide(),showItems(),updateCheckbox(),generateFiltersQueryParameter()},getMobileFiltersStructure:function(){var i=[];return $(".filters__item").each(function(){var t,e=$(this).find(".filter-checkbox:checked");e.length&&(t="",e.each(function(){t+=$(this).attr("name")+", "}),t=t.slice(0,-2),e={filterId:(e=$(this).find(".filters__item__header")).data("attr"),filterLabel:e.text().trim(),values:t},i.push(e))}),i},updateMobileFiltersBox:function(){var i,t=filters.getMobileFiltersStructure();t&&t.length?(i="",t.forEach(function(t){var e="IS_NEW"===t.filterId||"IS_COMMERCIAL"===t.filterId||"CAN_BUY_ONLINE"===t.filterId?"visuallyHidden":"";i+="<li class='filter_item' data-attr='"+t.filterId+"'>       <span class='filter_category "+e+"'>"+t.filterLabel+": </span>       <span class='filter_values'>"+(e?t.values.charAt(0).toUpperCase()+t.values.slice(1):t.values)+"</span>       <button type='button' class='remove-filter text-dark' data-attr='"+t.filterId+"'>           <span class='icon' aria-hidden='true'></span>           <span class='text visuallyHidden'>Remove Filters</span>       </button>   </li>"}),this.$filtersActiveBox.find("ul").html(i),this.$filtersActiveBox.show()):this.$filtersActiveBox.hide()},updateMobileFiltersTotal:function(){$(".products-list-page__content").each(function(){var t=$(this),e=$(t).find("#product-list-container").find(".listItem:visible").length;$(t).find(".filters_total_results").find(".count").html(e),1===e?($(t).find(".filters_total_one").show(),$(t).find(".filters_total_many").hide()):($(t).find(".filters_total_one").hide(),$(t).find(".filters_total_many").show())})},bindEvents:function(){this.$filtersBtnReset.on("click",function(){this.resetFilters(!0)}.bind(this)),this.$productFilters.on("shown.bs.collapse",function(t){t.target.id===this._productFiltersSelector&&(this.$body.addClass("filters_opened"),this.$filtersActiveBox.hide(),this.scrollTop())}.bind(this)),this.$productFilters.on("hidden.bs.collapse",function(t){t.target.id===this._productFiltersSelector&&(this.updateMobileFiltersBox(),this.updateMobileFiltersTotal(),this.$body.removeClass("filters_opened"),this.scrollTop())}.bind(this)),$("body").on("click",".remove-filter",function(){var t=$(this).data("attr");t&&(filters.resetSingleFilterGroup(t),filters.updateMobileFiltersTotal())})},init:function(){try{this.setup(),this.bindEvents(),this.updateMobileFiltersBox(),this.updateMobileFiltersTotal()}catch(t){console.error(t)}}};$(document).ready(function(){$(".filters input").on("click",function(){showItems(),updateCheckbox(),generateFiltersQueryParameter(),filters.updateMobileFiltersTotal();var t=$(this).is(":checked");window.dataLayer=window.dataLayer||[],t&&window.dataLayer.push({event:"applicazione-filtro-listing",filterType:$(this).data("filter")||"",filterValue:$(this).attr("name")||""})}),$("#filters_reset_link").on("click",function(){filters.resetFilters(!1)}.bind(this)),$("#filters_reset_link_mobile").on("click",function(){filters.resetFilters(!0)}.bind(this)),applyFiltersFromQueryParameter(),showUniqueFilters("IS_NEW"),showUniqueFilters("IS_COMMERCIAL_MODE"),showUniqueFilters("CAN_BUY_ONLINE"),hideFilterContainerIfEmpty(),initSortingButtons(),filters.init(),document.querySelectorAll(".filters__item__header").forEach(function(e){$(e).on("click",function(t){console.log($(t.target)),$(t.target).hasClass("collapsed")?$(t.target.parentElement).attr("aria-expanded",!0):$(t.target.parentElement).attr("aria-expanded",!1)}),$(e).on("keydown",function(t){"Enter"===t.key&&e.click()})})});
//# sourceMappingURL=filters.min.js.map